{"ast":null,"code":"'use strict';\n\nvar Tokenizer = require('../tokenizer'),\n    foreignContent = require('../common/foreign_content'),\n    UNICODE = require('../common/unicode'),\n    HTML = require('../common/html'); //Aliases\n\n\nvar $ = HTML.TAG_NAMES,\n    NS = HTML.NAMESPACES; //ParserFeedbackSimulator\n//Simulates adjustment of the Tokenizer which performed by standard parser during tree construction.\n\nvar ParserFeedbackSimulator = module.exports = function (tokenizer) {\n  this.tokenizer = tokenizer;\n  this.namespaceStack = [];\n  this.namespaceStackTop = -1;\n\n  this._enterNamespace(NS.HTML);\n};\n\nParserFeedbackSimulator.prototype.getNextToken = function () {\n  var token = this.tokenizer.getNextToken();\n  if (token.type === Tokenizer.START_TAG_TOKEN) this._handleStartTagToken(token);else if (token.type === Tokenizer.END_TAG_TOKEN) this._handleEndTagToken(token);else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN && this.inForeignContent) {\n    token.type = Tokenizer.CHARACTER_TOKEN;\n    token.chars = UNICODE.REPLACEMENT_CHARACTER;\n  } else if (this.skipNextNewLine) {\n    if (token.type !== Tokenizer.HIBERNATION_TOKEN) this.skipNextNewLine = false;\n\n    if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n      if (token.chars.length === 1) return this.getNextToken();\n      token.chars = token.chars.substr(1);\n    }\n  }\n  return token;\n}; //Namespace stack mutations\n\n\nParserFeedbackSimulator.prototype._enterNamespace = function (namespace) {\n  this.namespaceStackTop++;\n  this.namespaceStack.push(namespace);\n  this.inForeignContent = namespace !== NS.HTML;\n  this.currentNamespace = namespace;\n  this.tokenizer.allowCDATA = this.inForeignContent;\n};\n\nParserFeedbackSimulator.prototype._leaveCurrentNamespace = function () {\n  this.namespaceStackTop--;\n  this.namespaceStack.pop();\n  this.currentNamespace = this.namespaceStack[this.namespaceStackTop];\n  this.inForeignContent = this.currentNamespace !== NS.HTML;\n  this.tokenizer.allowCDATA = this.inForeignContent;\n}; //Token handlers\n\n\nParserFeedbackSimulator.prototype._ensureTokenizerMode = function (tn) {\n  if (tn === $.TEXTAREA || tn === $.TITLE) this.tokenizer.state = Tokenizer.MODE.RCDATA;else if (tn === $.PLAINTEXT) this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;else if (tn === $.SCRIPT) this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;else if (tn === $.STYLE || tn === $.IFRAME || tn === $.XMP || tn === $.NOEMBED || tn === $.NOFRAMES || tn === $.NOSCRIPT) this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n};\n\nParserFeedbackSimulator.prototype._handleStartTagToken = function (token) {\n  var tn = token.tagName;\n  if (tn === $.SVG) this._enterNamespace(NS.SVG);else if (tn === $.MATH) this._enterNamespace(NS.MATHML);\n\n  if (this.inForeignContent) {\n    if (foreignContent.causesExit(token)) {\n      this._leaveCurrentNamespace();\n\n      return;\n    }\n\n    var currentNs = this.currentNamespace;\n    if (currentNs === NS.MATHML) foreignContent.adjustTokenMathMLAttrs(token);else if (currentNs === NS.SVG) {\n      foreignContent.adjustTokenSVGTagName(token);\n      foreignContent.adjustTokenSVGAttrs(token);\n    }\n    foreignContent.adjustTokenXMLAttrs(token);\n    tn = token.tagName;\n    if (!token.selfClosing && foreignContent.isIntegrationPoint(tn, currentNs, token.attrs)) this._enterNamespace(NS.HTML);\n  } else {\n    if (tn === $.PRE || tn === $.TEXTAREA || tn === $.LISTING) this.skipNextNewLine = true;else if (tn === $.IMAGE) token.tagName = $.IMG;\n\n    this._ensureTokenizerMode(tn);\n  }\n};\n\nParserFeedbackSimulator.prototype._handleEndTagToken = function (token) {\n  var tn = token.tagName;\n\n  if (!this.inForeignContent) {\n    var previousNs = this.namespaceStack[this.namespaceStackTop - 1];\n    if (previousNs === NS.SVG && foreignContent.SVG_TAG_NAMES_ADJUSTMENT_MAP[tn]) tn = foreignContent.SVG_TAG_NAMES_ADJUSTMENT_MAP[tn]; //NOTE: check for exit from integration point\n\n    if (foreignContent.isIntegrationPoint(tn, previousNs, token.attrs)) this._leaveCurrentNamespace();\n  } else if (tn === $.SVG && this.currentNamespace === NS.SVG || tn === $.MATH && this.currentNamespace === NS.MATHML) this._leaveCurrentNamespace(); // NOTE: adjust end tag name as well for consistency\n\n\n  if (this.currentNamespace === NS.SVG) foreignContent.adjustTokenSVGTagName(token);\n};","map":{"version":3,"sources":["/Users/lambda_school_loaner_244/Desktop/LAMBDA/projects/projectsCollection/node_modules/parse5/lib/sax/parser_feedback_simulator.js"],"names":["Tokenizer","require","foreignContent","UNICODE","HTML","$","TAG_NAMES","NS","NAMESPACES","ParserFeedbackSimulator","module","exports","tokenizer","namespaceStack","namespaceStackTop","_enterNamespace","prototype","getNextToken","token","type","START_TAG_TOKEN","_handleStartTagToken","END_TAG_TOKEN","_handleEndTagToken","NULL_CHARACTER_TOKEN","inForeignContent","CHARACTER_TOKEN","chars","REPLACEMENT_CHARACTER","skipNextNewLine","HIBERNATION_TOKEN","WHITESPACE_CHARACTER_TOKEN","length","substr","namespace","push","currentNamespace","allowCDATA","_leaveCurrentNamespace","pop","_ensureTokenizerMode","tn","TEXTAREA","TITLE","state","MODE","RCDATA","PLAINTEXT","SCRIPT","SCRIPT_DATA","STYLE","IFRAME","XMP","NOEMBED","NOFRAMES","NOSCRIPT","RAWTEXT","tagName","SVG","MATH","MATHML","causesExit","currentNs","adjustTokenMathMLAttrs","adjustTokenSVGTagName","adjustTokenSVGAttrs","adjustTokenXMLAttrs","selfClosing","isIntegrationPoint","attrs","PRE","LISTING","IMAGE","IMG","previousNs","SVG_TAG_NAMES_ADJUSTMENT_MAP"],"mappings":"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","sourcesContent":["'use strict';\n\nvar Tokenizer = require('../tokenizer'),\n    foreignContent = require('../common/foreign_content'),\n    UNICODE = require('../common/unicode'),\n    HTML = require('../common/html');\n\n\n//Aliases\nvar $ = HTML.TAG_NAMES,\n    NS = HTML.NAMESPACES;\n\n\n//ParserFeedbackSimulator\n//Simulates adjustment of the Tokenizer which performed by standard parser during tree construction.\nvar ParserFeedbackSimulator = module.exports = function (tokenizer) {\n    this.tokenizer = tokenizer;\n\n    this.namespaceStack = [];\n    this.namespaceStackTop = -1;\n    this._enterNamespace(NS.HTML);\n};\n\nParserFeedbackSimulator.prototype.getNextToken = function () {\n    var token = this.tokenizer.getNextToken();\n\n    if (token.type === Tokenizer.START_TAG_TOKEN)\n        this._handleStartTagToken(token);\n\n    else if (token.type === Tokenizer.END_TAG_TOKEN)\n        this._handleEndTagToken(token);\n\n    else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN && this.inForeignContent) {\n        token.type = Tokenizer.CHARACTER_TOKEN;\n        token.chars = UNICODE.REPLACEMENT_CHARACTER;\n    }\n\n    else if (this.skipNextNewLine) {\n        if (token.type !== Tokenizer.HIBERNATION_TOKEN)\n            this.skipNextNewLine = false;\n\n        if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n            if (token.chars.length === 1)\n                return this.getNextToken();\n\n            token.chars = token.chars.substr(1);\n        }\n    }\n\n    return token;\n};\n\n//Namespace stack mutations\nParserFeedbackSimulator.prototype._enterNamespace = function (namespace) {\n    this.namespaceStackTop++;\n    this.namespaceStack.push(namespace);\n\n    this.inForeignContent = namespace !== NS.HTML;\n    this.currentNamespace = namespace;\n    this.tokenizer.allowCDATA = this.inForeignContent;\n};\n\nParserFeedbackSimulator.prototype._leaveCurrentNamespace = function () {\n    this.namespaceStackTop--;\n    this.namespaceStack.pop();\n\n    this.currentNamespace = this.namespaceStack[this.namespaceStackTop];\n    this.inForeignContent = this.currentNamespace !== NS.HTML;\n    this.tokenizer.allowCDATA = this.inForeignContent;\n};\n\n//Token handlers\nParserFeedbackSimulator.prototype._ensureTokenizerMode = function (tn) {\n    if (tn === $.TEXTAREA || tn === $.TITLE)\n        this.tokenizer.state = Tokenizer.MODE.RCDATA;\n\n    else if (tn === $.PLAINTEXT)\n        this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n\n    else if (tn === $.SCRIPT)\n        this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;\n\n    else if (tn === $.STYLE || tn === $.IFRAME || tn === $.XMP ||\n             tn === $.NOEMBED || tn === $.NOFRAMES || tn === $.NOSCRIPT)\n        this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n};\n\nParserFeedbackSimulator.prototype._handleStartTagToken = function (token) {\n    var tn = token.tagName;\n\n    if (tn === $.SVG)\n        this._enterNamespace(NS.SVG);\n\n    else if (tn === $.MATH)\n        this._enterNamespace(NS.MATHML);\n\n    if (this.inForeignContent) {\n        if (foreignContent.causesExit(token)) {\n            this._leaveCurrentNamespace();\n            return;\n        }\n\n        var currentNs = this.currentNamespace;\n\n        if (currentNs === NS.MATHML)\n            foreignContent.adjustTokenMathMLAttrs(token);\n\n        else if (currentNs === NS.SVG) {\n            foreignContent.adjustTokenSVGTagName(token);\n            foreignContent.adjustTokenSVGAttrs(token);\n        }\n\n        foreignContent.adjustTokenXMLAttrs(token);\n\n        tn = token.tagName;\n\n        if (!token.selfClosing && foreignContent.isIntegrationPoint(tn, currentNs, token.attrs))\n            this._enterNamespace(NS.HTML);\n    }\n\n    else {\n        if (tn === $.PRE || tn === $.TEXTAREA || tn === $.LISTING)\n            this.skipNextNewLine = true;\n\n        else if (tn === $.IMAGE)\n            token.tagName = $.IMG;\n\n        this._ensureTokenizerMode(tn);\n    }\n};\n\nParserFeedbackSimulator.prototype._handleEndTagToken = function (token) {\n    var tn = token.tagName;\n\n    if (!this.inForeignContent) {\n        var previousNs = this.namespaceStack[this.namespaceStackTop - 1];\n\n        if (previousNs === NS.SVG && foreignContent.SVG_TAG_NAMES_ADJUSTMENT_MAP[tn])\n            tn = foreignContent.SVG_TAG_NAMES_ADJUSTMENT_MAP[tn];\n\n        //NOTE: check for exit from integration point\n        if (foreignContent.isIntegrationPoint(tn, previousNs, token.attrs))\n            this._leaveCurrentNamespace();\n    }\n\n    else if (tn === $.SVG && this.currentNamespace === NS.SVG ||\n             tn === $.MATH && this.currentNamespace === NS.MATHML)\n        this._leaveCurrentNamespace();\n\n    // NOTE: adjust end tag name as well for consistency\n    if (this.currentNamespace === NS.SVG)\n        foreignContent.adjustTokenSVGTagName(token);\n};\n"]},"metadata":{},"sourceType":"script"}